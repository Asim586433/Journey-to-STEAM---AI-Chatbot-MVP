<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Journey to STEAM - AI Chatbot MVP</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
        }

        :root {
            --primary: #2D5AA0;
            --primary-dark: #1E3A8A;
            --primary-light: #EFF6FF;
            --accent: #FF6B35;
            --accent-dark: #E55A2B;
            --accent-light: #FFEDE5;
            --light: #F8FAFC;
            --dark: #1E293B;
            --gray: #64748B;
            --gray-light: #E2E8F0;
            --success: #10B981;
            --success-light: #D1FAE5;
            --warning: #F59E0B;
            --danger: #EF4444;
            --danger-light: #FEE2E2;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --radius: 12px;
            --radius-sm: 8px;
            --radius-lg: 16px;
        }

        body {
            background: var(--light);
            color: var(--dark);
            min-height: 100vh;
            line-height: 1.6;
        }

        /* Navigation */
        .navbar {
            background: white;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
            padding: 0 24px;
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 70px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
            color: var(--dark);
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 18px;
        }

        .logo-text h1 {
            font-size: 20px;
            font-weight: 700;
        }

        .logo-text p {
            font-size: 12px;
            color: var(--gray);
        }

        .nav-links {
            display: flex;
            gap: 32px;
            align-items: center;
        }

        .nav-link {
            text-decoration: none;
            color: var(--dark);
            font-weight: 500;
            padding: 8px 0;
            position: relative;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .nav-link:hover {
            color: var(--primary);
        }

        .nav-link.active {
            color: var(--primary);
            font-weight: 600;
        }

        .nav-link.active::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--primary);
            border-radius: 3px;
        }

        .nav-actions {
            display: flex;
            gap: 16px;
            align-items: center;
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            padding: 8px 16px;
            border-radius: var(--radius-sm);
            transition: all 0.3s;
        }

        .user-menu:hover {
            background: var(--gray-light);
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            background: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .btn {
            padding: 10px 24px;
            border-radius: var(--radius-sm);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            text-decoration: none;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .btn-accent {
            background: var(--accent);
            color: white;
        }

        .btn-accent:hover {
            background: var(--accent-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .btn-outline {
            background: transparent;
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .btn-outline:hover {
            background: var(--primary);
            color: white;
        }

        .btn-small {
            padding: 6px 16px;
            font-size: 13px;
        }

        /* Main Content */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 24px;
        }

        /* Page Container */
        .page {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Dashboard Page */
        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
            flex-wrap: wrap;
            gap: 16px;
        }

        .dashboard-header h1 {
            font-size: 28px;
            color: var(--dark);
        }

        .dashboard-header p {
            color: var(--gray);
            max-width: 600px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 24px;
            margin-bottom: 32px;
        }

        .stat-card {
            background: white;
            padding: 24px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 20px;
            transition: all 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
        }

        .stat-icon.chat { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .stat-icon.lead { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
        .stat-icon.time { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
        .stat-icon.escalation { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }

        .stat-content h3 {
            font-size: 14px;
            color: var(--gray);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
        }

        .stat-content .value {
            font-size: 32px;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 4px;
        }

        .stat-content .trend {
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .trend.up {
            color: var(--success);
        }

        .trend.down {
            color: var(--danger);
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 32px;
            margin-bottom: 32px;
        }

        @media (max-width: 1024px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .card-header {
            padding: 20px 24px;
            border-bottom: 1px solid var(--gray-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-header h3 {
            font-size: 18px;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-content {
            padding: 24px;
        }

        /* Chat Widget */
        .chat-widget-container {
            height: 500px;
            display: flex;
            flex-direction: column;
            background: var(--light);
            border-radius: var(--radius-sm);
            overflow: hidden;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .chat-message {
            max-width: 75%;
            padding: 12px 16px;
            border-radius: var(--radius-sm);
            line-height: 1.5;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message-user {
            background: var(--primary);
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 4px;
        }

        .message-assistant {
            background: white;
            color: var(--dark);
            align-self: flex-start;
            border-bottom-left-radius: 4px;
            box-shadow: var(--shadow);
        }

        .message-system {
            background: var(--gray-light);
            color: var(--gray);
            align-self: center;
            font-size: 12px;
            padding: 8px 16px;
            border-radius: 20px;
            margin: 8px 0;
        }

        .chat-input-area {
            padding: 16px 20px;
            border-top: 1px solid var(--gray-light);
            background: white;
            display: flex;
            gap: 12px;
        }

        .chat-input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid var(--gray-light);
            border-radius: var(--radius-sm);
            font-size: 14px;
            transition: all 0.3s;
        }

        .chat-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(45, 90, 160, 0.1);
        }

        .typing-indicator {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 8px 16px;
            background: white;
            border-radius: var(--radius-sm);
            box-shadow: var(--shadow);
            align-self: flex-start;
        }

        .typing-indicator span {
            width: 6px;
            height: 6px;
            background: var(--gray);
            border-radius: 50%;
            animation: bounce 1.4s infinite ease-in-out;
        }

        .typing-indicator span:nth-child(1) { animation-delay: -0.32s; }
        .typing-indicator span:nth-child(2) { animation-delay: -0.16s; }

        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }

        /* Table Styles */
        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            background: var(--light);
        }

        th {
            padding: 16px;
            text-align: left;
            font-weight: 600;
            color: var(--gray);
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 2px solid var(--gray-light);
        }

        tbody tr {
            border-bottom: 1px solid var(--gray-light);
            transition: all 0.3s;
        }

        tbody tr:hover {
            background: var(--light);
        }

        td {
            padding: 16px;
            color: var(--dark);
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .badge-success {
            background: var(--success-light);
            color: var(--success);
        }

        .badge-warning {
            background: #FEF3C7;
            color: #D97706;
        }

        .badge-danger {
            background: var(--danger-light);
            color: var(--danger);
        }

        .badge-info {
            background: #DBEAFE;
            color: #1E40AF;
        }

        .action-buttons {
            display: flex;
            gap: 8px;
        }

        /* Conversations Page */
        .filters {
            display: flex;
            gap: 16px;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .filter-group label {
            font-size: 13px;
            color: var(--gray);
            font-weight: 500;
        }

        .filter-select {
            padding: 8px 16px;
            border: 2px solid var(--gray-light);
            border-radius: var(--radius-sm);
            background: white;
            min-width: 150px;
        }

        /* Knowledge Base Page */
        .knowledge-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 24px;
            margin-top: 24px;
        }

        .knowledge-card {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            transition: all 0.3s;
        }

        .knowledge-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .knowledge-card-header {
            padding: 20px;
            background: var(--primary);
            color: white;
        }

        .knowledge-card-header h3 {
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .knowledge-card-content {
            padding: 20px;
        }

        .knowledge-item {
            padding: 12px 0;
            border-bottom: 1px solid var(--gray-light);
        }

        .knowledge-item:last-child {
            border-bottom: none;
        }

        .knowledge-item strong {
            color: var(--dark);
            display: block;
            margin-bottom: 4px;
        }

        .knowledge-item p {
            color: var(--gray);
            font-size: 14px;
        }

        /* Settings Page */
        .settings-grid {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 32px;
            margin-top: 24px;
        }

        @media (max-width: 768px) {
            .settings-grid {
                grid-template-columns: 1fr;
            }
        }

        .settings-menu {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .settings-menu-item {
            padding: 16px 20px;
            border-bottom: 1px solid var(--gray-light);
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .settings-menu-item:hover {
            background: var(--light);
        }

        .settings-menu-item.active {
            background: var(--primary);
            color: white;
        }

        .settings-content {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 32px;
        }

        .settings-section {
            display: none;
        }

        .settings-section.active {
            display: block;
        }

        .settings-section h2 {
            font-size: 24px;
            margin-bottom: 24px;
            color: var(--dark);
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--gray-light);
            border-radius: var(--radius-sm);
            font-size: 14px;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(45, 90, 160, 0.1);
        }

        .form-group textarea {
            min-height: 120px;
            resize: vertical;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: var(--success);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(30px);
        }

        /* SMS Page */
        .sms-preview {
            background: #1F2937;
            color: white;
            border-radius: var(--radius);
            padding: 24px;
            margin-bottom: 24px;
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
        }

        .sms-bubble {
            background: #374151;
            padding: 12px 16px;
            border-radius: 18px;
            margin-bottom: 12px;
            max-width: 80%;
        }

        .sms-bubble.user {
            background: var(--primary);
            margin-left: auto;
        }

        .sms-bubble.assistant {
            background: #4B5563;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: var(--radius-lg);
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-lg);
            animation: modalIn 0.3s ease;
        }

        @keyframes modalIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        .modal-header {
            padding: 24px;
            border-bottom: 1px solid var(--gray-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            font-size: 20px;
            color: var(--dark);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--gray);
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s;
        }

        .modal-close:hover {
            background: var(--gray-light);
        }

        .modal-body {
            padding: 24px;
        }

        .modal-footer {
            padding: 24px;
            border-top: 1px solid var(--gray-light);
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 3000;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .toast {
            padding: 16px 20px;
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 12px;
            min-width: 300px;
            animation: slideInRight 0.3s ease;
            border-left: 4px solid var(--success);
        }

        .toast.error {
            border-left-color: var(--danger);
        }

        .toast.warning {
            border-left-color: var(--warning);
        }

        .toast.info {
            border-left-color: var(--primary);
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .toast-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
        }

        .toast-success .toast-icon {
            background: var(--success);
        }

        .toast-error .toast-icon {
            background: var(--danger);
        }

        .toast-warning .toast-icon {
            background: var(--warning);
        }

        .toast-info .toast-icon {
            background: var(--primary);
        }

        .toast-content {
            flex: 1;
        }

        .toast-content h4 {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 2px;
            color: var(--dark);
        }

        .toast-content p {
            font-size: 13px;
            color: var(--gray);
        }

        .toast-close {
            background: none;
            border: none;
            color: var(--gray);
            cursor: pointer;
            font-size: 18px;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            transition: all 0.3s;
        }

        .toast-close:hover {
            background: var(--gray-light);
        }

        /* Loading States */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid var(--gray-light);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .nav-links {
                gap: 16px;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .navbar {
                padding: 0 16px;
            }
            
            .nav-links {
                display: none;
            }
            
            .container {
                padding: 16px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
        }

        /* Embed Code Section */
        .embed-code {
            background: #1F2937;
            color: #E5E7EB;
            padding: 16px;
            border-radius: var(--radius-sm);
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 16px 0;
        }

        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .copy-btn {
            background: #374151;
            color: #E5E7EB;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.3s;
        }

        .copy-btn:hover {
            background: #4B5563;
        }
    </style>
</head>
<body>
    <!-- Toast Notifications Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="#" class="logo" data-page="dashboard">
                <div class="logo-icon">
                    <i class="fas fa-robot"></i>
                </div>
                <div class="logo-text">
                    <h1>STEAMBot</h1>
                    <p>Journey to STEAM AI Assistant</p>
                </div>
            </a>
            
            <div class="nav-links">
                <a href="#" class="nav-link active" data-page="dashboard">
                    <i class="fas fa-home"></i> Dashboard
                </a>
                <a href="#" class="nav-link" data-page="chat">
                    <i class="fas fa-comments"></i> Live Chat
                </a>
                <a href="#" class="nav-link" data-page="conversations">
                    <i class="fas fa-history"></i> Conversations
                </a>
                <a href="#" class="nav-link" data-page="knowledge">
                    <i class="fas fa-brain"></i> Knowledge Base
                </a>
                <a href="#" class="nav-link" data-page="sms">
                    <i class="fas fa-sms"></i> SMS
                </a>
                <a href="#" class="nav-link" data-page="analytics">
                    <i class="fas fa-chart-bar"></i> Analytics
                </a>
                <a href="#" class="nav-link" data-page="settings">
                    <i class="fas fa-cog"></i> Settings
                </a>
            </div>
            
            <div class="nav-actions">
                <div class="user-menu" id="userMenu">
                    <div class="user-avatar">AD</div>
                    <div>
                        <div style="font-weight: 600;">Admin User</div>
                        <div style="font-size: 12px; color: var(--gray);">Center Director</div>
                    </div>
                    <i class="fas fa-chevron-down"></i>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container">
        <!-- Dashboard Page -->
        <div class="page active" id="page-dashboard">
            <div class="dashboard-header">
                <div>
                    <h1>AI Chatbot Dashboard</h1>
                    <p>Monitor parent conversations, capture leads, and manage your AI assistant in real-time</p>
                </div>
                <div style="display: flex; gap: 12px;">
                    <button class="btn btn-accent" onclick="showModal('embedModal')">
                        <i class="fas fa-code"></i> Get Embed Code
                    </button>
                    <button class="btn btn-primary" onclick="navigateTo('chat')">
                        <i class="fas fa-comment"></i> Test Chat
                    </button>
                </div>
            </div>

            <!-- Stats Grid -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon chat">
                        <i class="fas fa-comments"></i>
                    </div>
                    <div class="stat-content">
                        <h3>Today's Conversations</h3>
                        <div class="value" id="statConversations">42</div>
                        <div class="trend up">
                            <i class="fas fa-arrow-up"></i> 18% from yesterday
                        </div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon lead">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-content">
                        <h3>Leads Captured</h3>
                        <div class="value" id="statLeads">14</div>
                        <div class="trend up">
                            <i class="fas fa-arrow-up"></i> 6 this week
                        </div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon time">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="stat-content">
                        <h3>Avg Response Time</h3>
                        <div class="value">1.8s</div>
                        <div class="trend down">
                            <i class="fas fa-arrow-down"></i> 0.4s faster
                        </div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon escalation">
                        <i class="fas fa-exclamation-circle"></i>
                    </div>
                    <div class="stat-content">
                        <h3>Human Escalations</h3>
                        <div class="value">3</div>
                        <div class="trend down">
                            <i class="fas fa-arrow-down"></i> 40% lower
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Grid -->
            <div class="dashboard-grid">
                <!-- Left Column -->
                <div>
                    <!-- Live Chat Preview -->
                    <div class="card">
                        <div class="card-header">
                            <h3><i class="fas fa-comment-dots"></i> Live Chat Preview</h3>
                            <div style="display: flex; gap: 8px;">
                                <span class="badge badge-success">Online</span>
                                <span class="badge badge-info">2 Active</span>
                            </div>
                        </div>
                        <div class="card-content">
                            <div class="chat-widget-container">
                                <div class="chat-messages" id="dashboardChat">
                                    <div class="chat-message message-system">
                                        <i class="fas fa-info-circle"></i> STEAMBot is ready to help parents with questions
                                    </div>
                                    <div class="chat-message message-assistant">
                                        Hi there! I'm STEAMBot, your AI assistant for Journey to STEAM. How can I help you today?
                                    </div>
                                    <div class="chat-message message-user">
                                        What's the cost of robotics class?
                                    </div>
                                    <div class="chat-message message-assistant">
                                        Our Robotics Engineering program is $120/month for ages 8-12. Classes are Mon/Wed 4-5:30 PM. All materials are included!
                                    </div>
                                </div>
                                <div class="chat-input-area">
                                    <input type="text" class="chat-input" placeholder="Type a test message..." id="dashboardInput">
                                    <button class="btn btn-primary btn-small" onclick="sendDashboardMessage()">Send</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Conversations -->
                    <div class="card" style="margin-top: 24px;">
                        <div class="card-header">
                            <h3><i class="fas fa-history"></i> Recent Conversations</h3>
                            <button class="btn btn-outline btn-small" onclick="navigateTo('conversations')">
                                View All <i class="fas fa-arrow-right"></i>
                            </button>
                        </div>
                        <div class="card-content">
                            <div class="table-container">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Time</th>
                                            <th>Parent</th>
                                            <th>Message</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="recentConversations">
                                        <!-- Populated by JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Column -->
                <div>
                    <!-- Quick Actions -->
                    <div class="card">
                        <div class="card-header">
                            <h3><i class="fas fa-bolt"></i> Quick Actions</h3>
                        </div>
                        <div class="card-content">
                            <div style="display: flex; flex-direction: column; gap: 12px;">
                                <button class="btn btn-primary" onclick="showModal('knowledgeModal')">
                                    <i class="fas fa-edit"></i> Update Knowledge Base
                                </button>
                                <button class="btn btn-accent" onclick="showModal('smsModal')">
                                    <i class="fas fa-sms"></i> Send Test SMS
                                </button>
                                <button class="btn btn-outline" onclick="exportData('leads')">
                                    <i class="fas fa-download"></i> Export Leads
                                </button>
                                <button class="btn btn-outline" onclick="exportData('conversations')">
                                    <i class="fas fa-file-export"></i> Export Conversations
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Lead Capture -->
                    <div class="card" style="margin-top: 24px;">
                        <div class="card-header">
                            <h3><i class="fas fa-user-plus"></i> Quick Lead Capture</h3>
                        </div>
                        <div class="card-content">
                            <div class="form-group">
                                <label for="quickName">Parent Name</label>
                                <input type="text" id="quickName" placeholder="Enter name">
                            </div>
                            <div class="form-group">
                                <label for="quickEmail">Email Address</label>
                                <input type="email" id="quickEmail" placeholder="email@example.com">
                            </div>
                            <div class="form-group">
                                <label for="quickProgram">Program Interest</label>
                                <select id="quickProgram">
                                    <option value="">Select program</option>
                                    <option value="robotics">Robotics Engineering</option>
                                    <option value="coding">Coding & Game Dev</option>
                                    <option value="science">Science Experiments</option>
                                    <option value="math">Math Enrichment</option>
                                </select>
                            </div>
                            <button class="btn btn-accent" style="width: 100%;" onclick="captureQuickLead()">
                                <i class="fas fa-save"></i> Capture Lead
                            </button>
                        </div>
                    </div>

                    <!-- System Status -->
                    <div class="card" style="margin-top: 24px;">
                        <div class="card-header">
                            <h3><i class="fas fa-server"></i> System Status</h3>
                        </div>
                        <div class="card-content">
                            <div style="display: flex; flex-direction: column; gap: 12px;">
                                <div style="display: flex; justify-content: space-between;">
                                    <span>Claude API</span>
                                    <span class="badge badge-success">Online</span>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span>Twilio SMS</span>
                                    <span class="badge badge-success">Online</span>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span>Database</span>
                                    <span class="badge badge-success">Connected</span>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span>Widget Uptime</span>
                                    <span class="badge badge-success">99.8%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chat Page -->
        <div class="page" id="page-chat">
            <div class="dashboard-header">
                <div>
                    <h1>Live Chat Testing</h1>
                    <p>Test the AI chatbot interface that parents will see on your website</p>
                </div>
                <div>
                    <button class="btn btn-outline" onclick="resetChat()">
                        <i class="fas fa-redo"></i> Reset Chat
                    </button>
                </div>
            </div>

            <div class="card">
                <div class="card-content">
                    <div class="chat-widget-container" style="height: 600px;">
                        <div class="chat-messages" id="liveChat">
                            <div class="chat-message message-system">
                                <i class="fas fa-info-circle"></i> Welcome to STEAMBot! I can help with program information, schedules, pricing, and policies. I'm designed to assist but will escalate to human support when needed.
                            </div>
                            <div class="chat-message message-assistant">
                                Hello! I'm STEAMBot, your AI assistant for Journey to STEAM. I can help answer questions about our programs, schedule, pricing, and enrollment process. What would you like to know?
                            </div>
                        </div>
                        <div class="chat-input-area">
                            <input type="text" class="chat-input" placeholder="Type your question here..." id="liveChatInput" onkeypress="if(event.key === 'Enter') sendLiveChatMessage()">
                            <button class="btn btn-primary" onclick="sendLiveChatMessage()" id="liveChatButton">
                                Send <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div style="margin-top: 24px; display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 16px;">
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-lightbulb"></i> Try These Questions</h3>
                    </div>
                    <div class="card-content">
                        <div style="display: flex; flex-direction: column; gap: 10px;">
                            <button class="btn btn-outline btn-small" onclick="quickQuestion('What programs do you offer?')">
                                What programs do you offer?
                            </button>
                            <button class="btn btn-outline btn-small" onclick="quickQuestion('How much does robotics cost?')">
                                How much does robotics cost?
                            </button>
                            <button class="btn btn-outline btn-small" onclick="quickQuestion('What are your hours?')">
                                What are your hours?
                            </button>
                            <button class="btn btn-outline btn-small" onclick="quickQuestion('Can I enroll my 7 year old?')">
                                Can I enroll my 7 year old?
                            </button>
                            <button class="btn btn-outline btn-small" onclick="quickQuestion('Do you offer trial classes?')">
                                Do you offer trial classes?
                            </button>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-shield-alt"></i> Guardrail Testing</h3>
                    </div>
                    <div class="card-content">
                        <div style="display: flex; flex-direction: column; gap: 10px;">
                            <button class="btn btn-outline btn-small" onclick="quickQuestion('I want to enroll my child now')">
                                Test: Enrollment Request
                            </button>
                            <button class="btn btn-outline btn-small" onclick="quickQuestion('Can I pay by credit card?')">
                                Test: Payment Processing
                            </button>
                            <button class="btn btn-outline btn-small" onclick="quickQuestion('My child has allergies')">
                                Test: Medical Advice
                            </button>
                            <button class="btn btn-outline btn-small" onclick="quickQuestion('I need to speak to a human')">
                                Test: Human Escalation
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Conversations Page -->
        <div class="page" id="page-conversations">
            <div class="dashboard-header">
                <div>
                    <h1>All Conversations</h1>
                    <p>View and manage all chatbot conversations with parents</p>
                </div>
                <div style="display: flex; gap: 12px;">
                    <button class="btn btn-outline" onclick="exportConversations()">
                        <i class="fas fa-download"></i> Export All
                    </button>
                    <button class="btn btn-primary" onclick="refreshConversations()">
                        <i class="fas fa-sync"></i> Refresh
                    </button>
                </div>
            </div>

            <!-- Filters -->
            <div class="filters">
                <div class="filter-group">
                    <label for="filterDate">Date Range</label>
                    <select class="filter-select" id="filterDate" onchange="filterConversations()">
                        <option value="today">Today</option>
                        <option value="yesterday">Yesterday</option>
                        <option value="week">Last 7 Days</option>
                        <option value="month">Last 30 Days</option>
                        <option value="all">All Time</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="filterChannel">Channel</label>
                    <select class="filter-select" id="filterChannel" onchange="filterConversations()">
                        <option value="all">All Channels</option>
                        <option value="web">Web Chat</option>
                        <option value="sms">SMS</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="filterStatus">Status</label>
                    <select class="filter-select" id="filterStatus" onchange="filterConversations()">
                        <option value="all">All Status</option>
                        <option value="active">Active</option>
                        <option value="completed">Completed</option>
                        <option value="escalated">Escalated</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="searchConversations">Search</label>
                    <input type="text" class="filter-select" id="searchConversations" placeholder="Search messages..." oninput="filterConversations()">
                </div>
            </div>

            <!-- Conversations Table -->
            <div class="card">
                <div class="card-content">
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Time</th>
                                    <th>Parent</th>
                                    <th>Channel</th>
                                    <th>Last Message</th>
                                    <th>Status</th>
                                    <th>Lead Captured</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="allConversations">
                                <!-- Populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                    <div style="margin-top: 20px; text-align: center;">
                        <button class="btn btn-outline" onclick="loadMoreConversations()">
                            <i class="fas fa-plus"></i> Load More Conversations
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Knowledge Base Page -->
        <div class="page" id="page-knowledge">
            <div class="dashboard-header">
                <div>
                    <h1>Knowledge Base Management</h1>
                    <p>Manage the information that powers your AI assistant's responses</p>
                </div>
                <div>
                    <button class="btn btn-primary" onclick="showModal('addProgramModal')">
                        <i class="fas fa-plus"></i> Add Program
                    </button>
                </div>
            </div>

            <!-- Programs -->
            <div class="card">
                <div class="card-header">
                    <h3><i class="fas fa-graduation-cap"></i> Programs</h3>
                </div>
                <div class="card-content">
                    <div class="knowledge-grid" id="programsGrid">
                        <!-- Programs will be populated here -->
                    </div>
                </div>
            </div>

            <!-- FAQs -->
            <div class="card" style="margin-top: 24px;">
                <div class="card-header">
                    <h3><i class="fas fa-question-circle"></i> Frequently Asked Questions</h3>
                    <button class="btn btn-outline btn-small" onclick="showModal('addFaqModal')">
                        <i class="fas fa-plus"></i> Add FAQ
                    </button>
                </div>
                <div class="card-content">
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Question</th>
                                    <th>Answer</th>
                                    <th>Category</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="faqsTable">
                                <!-- FAQs will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Guardrails -->
            <div class="card" style="margin-top: 24px;">
                <div class="card-header">
                    <h3><i class="fas fa-shield-alt"></i> AI Guardrails</h3>
                </div>
                <div class="card-content">
                    <div style="display: flex; flex-direction: column; gap: 12px;">
                        <div style="display: flex; align-items: center; justify-content: space-between; padding: 12px; background: var(--light); border-radius: var(--radius-sm);">
                            <div>
                                <strong>Never confirm enrollment</strong>
                                <p style="font-size: 13px; color: var(--gray); margin-top: 4px;">AI must direct to website registration instead</p>
                            </div>
                            <span class="badge badge-success">Active</span>
                        </div>
                        <div style="display: flex; align-items: center; justify-content: space-between; padding: 12px; background: var(--light); border-radius: var(--radius-sm);">
                            <div>
                                <strong>Never process payments</strong>
                                <p style="font-size: 13px; color: var(--gray); margin-top: 4px;">AI can provide pricing but must direct to website</p>
                            </div>
                            <span class="badge badge-success">Active</span>
                        </div>
                        <div style="display: flex; align-items: center; justify-content: space-between; padding: 12px; background: var(--light); border-radius: var(--radius-sm);">
                            <div>
                                <strong>Never give medical advice</strong>
                                <p style="font-size: 13px; color: var(--gray); margin-top: 4px;">AI must escalate to human for health-related questions</p>
                            </div>
                            <span class="badge badge-success">Active</span>
                        </div>
                        <div style="display: flex; align-items: center; justify-content: space-between; padding: 12px; background: var(--light); border-radius: var(--radius-sm);">
                            <div>
                                <strong>Always escalate when uncertain</strong>
                                <p style="font-size: 13px; color: var(--gray); margin-top: 4px;">AI should transfer to human support if unsure</p>
                            </div>
                            <span class="badge badge-success">Active</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- SMS Page -->
        <div class="page" id="page-sms">
            <div class="dashboard-header">
                <div>
                    <h1>SMS Integration</h1>
                    <p>Manage and test SMS conversations with parents via Twilio</p>
                </div>
                <div>
                    <button class="btn btn-primary" onclick="showModal('smsTestModal')">
                        <i class="fas fa-sms"></i> Send Test SMS
                    </button>
                </div>
            </div>

            <!-- SMS Preview -->
            <div class="card">
                <div class="card-header">
                    <h3><i class="fas fa-comment-sms"></i> SMS Conversation Preview</h3>
                    <div style="display: flex; gap: 8px;">
                        <span class="badge badge-success">Twilio Active</span>
                        <span class="badge badge-info">+1 (555) 123-4567</span>
                    </div>
                </div>
                <div class="card-content">
                    <div class="sms-preview">
                        <div class="sms-bubble user">
                            Hi, can you tell me about your robotics program?
                        </div>
                        <div class="sms-bubble assistant">
                            Our Robotics Engineering program is for ages 8-12, $120/month, Mon/Wed 4-5:30 PM. All materials included!
                        </div>
                        <div class="sms-bubble user">
                            Do you have a free trial?
                        </div>
                        <div class="sms-bubble assistant">
                            Yes! We offer one free trial class for all new students. Would you like me to send you the signup link?
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-top: 24px;">
                        <div>
                            <h4 style="margin-bottom: 12px;">SMS Statistics</h4>
                            <div style="display: flex; flex-direction: column; gap: 8px;">
                                <div style="display: flex; justify-content: space-between;">
                                    <span>Messages Today</span>
                                    <strong>24</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span>Avg Response Time</span>
                                    <strong>4.2s</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span>Conversion Rate</span>
                                    <strong>18%</strong>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h4 style="margin-bottom: 12px;">Quick Actions</h4>
                            <div style="display: flex; flex-direction: column; gap: 8px;">
                                <button class="btn btn-outline btn-small" onclick="updateSmsNumber()">
                                    Update Phone Number
                                </button>
                                <button class="btn btn-outline btn-small" onclick="exportSmsLogs()">
                                    Export SMS Logs
                                </button>
                                <button class="btn btn-outline btn-small" onclick="testSmsDelivery()">
                                    Test Delivery
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recent SMS Conversations -->
            <div class="card" style="margin-top: 24px;">
                <div class="card-header">
                    <h3><i class="fas fa-sms"></i> Recent SMS Conversations</h3>
                </div>
                <div class="card-content">
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Phone Number</th>
                                    <th>Last Message</th>
                                    <th>Time</th>
                                    <th>Status</th>
                                    <th>Lead</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="smsConversations">
                                <!-- Populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analytics Page -->
        <div class="page" id="page-analytics">
            <div class="dashboard-header">
                <div>
                    <h1>Analytics & Insights</h1>
                    <p>Track performance, conversions, and chatbot effectiveness</p>
                </div>
                <div>
                    <select class="filter-select" id="analyticsPeriod" onchange="updateAnalytics()">
                        <option value="7">Last 7 Days</option>
                        <option value="30" selected>Last 30 Days</option>
                        <option value="90">Last 90 Days</option>
                    </select>
                </div>
            </div>

            <!-- Analytics Cards -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon chat">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="stat-content">
                        <h3>Total Conversations</h3>
                        <div class="value">1,247</div>
                        <div class="trend up">
                            <i class="fas fa-arrow-up"></i> 24% increase
                        </div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon lead">
                        <i class="fas fa-chart-pie"></i>
                    </div>
                    <div class="stat-content">
                        <h3>Conversion Rate</h3>
                        <div class="value">22.4%</div>
                        <div class="trend up">
                            <i class="fas fa-arrow-up"></i> 3.2% increase
                        </div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon time">
                        <i class="fas fa-chart-bar"></i>
                    </div>
                    <div class="stat-content">
                        <h3>Avg Session Time</h3>
                        <div class="value">4.2m</div>
                        <div class="trend up">
                            <i class="fas fa-arrow-up"></i> 0.8m longer
                        </div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon escalation">
                        <i class="fas fa-chart-area"></i>
                    </div>
                    <div class="stat-content">
                        <h3>AI Confidence</h3>
                        <div class="value">89.7%</div>
                        <div class="trend up">
                            <i class="fas fa-arrow-up"></i> 5.1% improvement
                        </div>
                    </div>
                </div>
            </div>

            <!-- Charts Grid -->
            <div class="dashboard-grid" style="margin-top: 24px;">
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-chart-line"></i> Conversations Over Time</h3>
                    </div>
                    <div class="card-content">
                        <div style="height: 300px; display: flex; align-items: center; justify-content: center; background: var(--light); border-radius: var(--radius-sm);">
                            <div style="text-align: center;">
                                <i class="fas fa-chart-line" style="font-size: 48px; color: var(--gray); margin-bottom: 16px;"></i>
                                <p>Conversation volume chart would appear here</p>
                                <p style="font-size: 13px; color: var(--gray);">In production, this would show time-series data</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-chart-pie"></i> Program Interest</h3>
                    </div>
                    <div class="card-content">
                        <div style="height: 300px; display: flex; align-items: center; justify-content: center; background: var(--light); border-radius: var(--radius-sm);">
                            <div style="text-align: center;">
                                <i class="fas fa-chart-pie" style="font-size: 48px; color: var(--gray); margin-bottom: 16px;"></i>
                                <p>Program interest distribution chart</p>
                                <p style="font-size: 13px; color: var(--gray);">Showing Robotics (42%), Coding (28%), Science (18%), Math (12%)</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Top Questions -->
            <div class="card" style="margin-top: 24px;">
                <div class="card-header">
                    <h3><i class="fas fa-question-circle"></i> Top Questions Asked</h3>
                </div>
                <div class="card-content">
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Question</th>
                                    <th>Frequency</th>
                                    <th>Category</th>
                                    <th>AI Accuracy</th>
                                    <th>Avg Response Time</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>What programs do you offer?</td>
                                    <td>187</td>
                                    <td><span class="badge badge-info">General</span></td>
                                    <td><span class="badge badge-success">98%</span></td>
                                    <td>1.2s</td>
                                </tr>
                                <tr>
                                    <td>How much does it cost?</td>
                                    <td>156</td>
                                    <td><span class="badge badge-info">Pricing</span></td>
                                    <td><span class="badge badge-success">96%</span></td>
                                    <td>1.5s</td>
                                </tr>
                                <tr>
                                    <td>What are your hours?</td>
                                    <td>142</td>
                                    <td><span class="badge badge-info">Schedule</span></td>
                                    <td><span class="badge badge-success">99%</span></td>
                                    <td>0.8s</td>
                                </tr>
                                <tr>
                                    <td>Can I enroll online?</td>
                                    <td>98</td>
                                    <td><span class="badge badge-warning">Enrollment</span></td>
                                    <td><span class="badge badge-success">95%</span></td>
                                    <td>2.1s</td>
                                </tr>
                                <tr>
                                    <td>Do you offer trial classes?</td>
                                    <td>87</td>
                                    <td><span class="badge badge-info">Trials</span></td>
                                    <td><span class="badge badge-success">97%</span></td>
                                    <td>1.8s</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Page -->
        <div class="page" id="page-settings">
            <div class="dashboard-header">
                <h1>Settings</h1>
            </div>

            <div class="settings-grid">
                <!-- Settings Menu -->
                <div class="settings-menu">
                    <div class="settings-menu-item active" data-settings="general">
                        <i class="fas fa-cog"></i> General Settings
                    </div>
                    <div class="settings-menu-item" data-settings="api">
                        <i class="fas fa-key"></i> API Configuration
                    </div>
                    <div class="settings-menu-item" data-settings="widget">
                        <i class="fas fa-window-restore"></i> Chat Widget
                    </div>
                    <div class="settings-menu-item" data-settings="notifications">
                        <i class="fas fa-bell"></i> Notifications
                    </div>
                    <div class="settings-menu-item" data-settings="team">
                        <i class="fas fa-users"></i> Team Access
                    </div>
                    <div class="settings-menu-item" data-settings="billing">
                        <i class="fas fa-credit-card"></i> Billing
                    </div>
                </div>

                <!-- Settings Content -->
                <div class="settings-content">
                    <!-- General Settings -->
                    <div class="settings-section active" id="settings-general">
                        <h2>General Settings</h2>
                        <div class="form-group">
                            <label for="businessName">Business Name</label>
                            <input type="text" id="businessName" value="Journey to STEAM" placeholder="Enter your business name">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="primaryColor">Primary Color</label>
                                <input type="color" id="primaryColor" value="#2D5AA0">
                            </div>
                            <div class="form-group">
                                <label for="accentColor">Accent Color</label>
                                <input type="color" id="accentColor" value="#FF6B35">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="timezone">Timezone</label>
                            <select id="timezone">
                                <option value="pacific" selected>Pacific Time (PT)</option>
                                <option value="mountain">Mountain Time (MT)</option>
                                <option value="central">Central Time (CT)</option>
                                <option value="eastern">Eastern Time (ET)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="workingHours">Working Hours</label>
                            <div style="display: flex; gap: 12px; align-items: center;">
                                <select id="startTime">
                                    <option>8:00 AM</option>
                                    <option>9:00 AM</option>
                                    <option selected>10:00 AM</option>
                                    <option>11:00 AM</option>
                                </select>
                                <span>to</span>
                                <select id="endTime">
                                    <option>4:00 PM</option>
                                    <option selected>5:00 PM</option>
                                    <option>6:00 PM</option>
                                    <option>7:00 PM</option>
                                </select>
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="saveSettings('general')">
                            Save General Settings
                        </button>
                    </div>

                    <!-- API Configuration -->
                    <div class="settings-section" id="settings-api">
                        <h2>API Configuration</h2>
                        <div class="form-group">
                            <label for="claudeApiKey">Claude API Key</label>
                            <input type="password" id="claudeApiKey" value="sk-ant-************" placeholder="Enter your Claude API key">
                            <p style="font-size: 13px; color: var(--gray); margin-top: 4px;">Your API key is securely encrypted and never stored in plain text</p>
                        </div>
                        <div class="form-group">
                            <label for="twilioSid">Twilio Account SID</label>
                            <input type="text" id="twilioSid" value="AC****************************" placeholder="Enter Twilio Account SID">
                        </div>
                        <div class="form-group">
                            <label for="twilioToken">Twilio Auth Token</label>
                            <input type="password" id="twilioToken" value="********************************" placeholder="Enter Twilio Auth Token">
                        </div>
                        <div class="form-group">
                            <label for="twilioNumber">Twilio Phone Number</label>
                            <input type="text" id="twilioNumber" value="+15551234567" placeholder="+1 (555) 123-4567">
                        </div>
                        <button class="btn btn-primary" onclick="saveSettings('api')">
                            Save API Configuration
                        </button>
                    </div>

                    <!-- Chat Widget Settings -->
                    <div class="settings-section" id="settings-widget">
                        <h2>Chat Widget Settings</h2>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="widgetEnabled" checked> Enable chat widget on website
                            </label>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="widgetMobile" checked> Show on mobile devices
                            </label>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="widgetDesktop" checked> Show on desktop
                            </label>
                        </div>
                        <div class="form-group">
                            <label for="widgetPosition">Widget Position</label>
                            <select id="widgetPosition">
                                <option value="bottom-right" selected>Bottom Right</option>
                                <option value="bottom-left">Bottom Left</option>
                                <option value="top-right">Top Right</option>
                                <option value="top-left">Top Left</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="welcomeMessage">Welcome Message</label>
                            <textarea id="welcomeMessage">Hello! I'm STEAMBot, your AI assistant for Journey to STEAM. How can I help you today?</textarea>
                        </div>
                        <div class="form-group">
                            <label for="offlineMessage">Offline Message</label>
                            <textarea id="offlineMessage">Thanks for reaching out! Our team is currently offline. Please leave a message and we'll get back to you during business hours.</textarea>
                        </div>
                        <button class="btn btn-primary" onclick="saveSettings('widget')">
                            Save Widget Settings
                        </button>
                    </div>

                    <!-- Notifications -->
                    <div class="settings-section" id="settings-notifications">
                        <h2>Notification Settings</h2>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="notifyLeads" checked> Email me when a lead is captured
                            </label>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="notifyEscalations" checked> Notify when conversation escalates to human
                            </label>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="notifySms" checked> Send SMS notifications for urgent inquiries
                            </label>
                        </div>
                        <div class="form-group">
                            <label for="notificationEmail">Notification Email</label>
                            <input type="email" id="notificationEmail" value="admin@journeytosteam.com" placeholder="Enter notification email">
                        </div>
                        <div class="form-group">
                            <label for="notificationPhone">Notification Phone</label>
                            <input type="text" id="notificationPhone" value="+15551234567" placeholder="+1 (555) 123-4567">
                        </div>
                        <button class="btn btn-primary" onclick="saveSettings('notifications')">
                            Save Notification Settings
                        </button>
                    </div>

                    <!-- Team Access -->
                    <div class="settings-section" id="settings-team">
                        <h2>Team Access</h2>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Email</th>
                                        <th>Role</th>
                                        <th>Last Active</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="teamMembers">
                                    <!-- Team members will be populated here -->
                                </tbody>
                            </table>
                        </div>
                        <button class="btn btn-primary" style="margin-top: 20px;" onclick="showModal('addTeamMemberModal')">
                            <i class="fas fa-plus"></i> Add Team Member
                        </button>
                    </div>

                    <!-- Billing -->
                    <div class="settings-section" id="settings-billing">
                        <h2>Billing Information</h2>
                        <div class="card" style="background: var(--light); border: none;">
                            <div class="card-content">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                    <div>
                                        <h3 style="margin-bottom: 4px;">Pro Plan</h3>
                                        <p style="color: var(--gray);">$99/month  Includes 5,000 messages</p>
                                    </div>
                                    <span class="badge badge-success">Active</span>
                                </div>
                                <div style="margin-bottom: 20px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                        <span>Messages this month</span>
                                        <strong>1,247 / 5,000</strong>
                                    </div>
                                    <div style="height: 8px; background: var(--gray-light); border-radius: 4px; overflow: hidden;">
                                        <div style="width: 25%; height: 100%; background: var(--primary);"></div>
                                    </div>
                                </div>
                                <div style="display: flex; gap: 12px;">
                                    <button class="btn btn-outline">Upgrade Plan</button>
                                    <button class="btn btn-primary">Update Payment Method</button>
                                </div>
                            </div>
                        </div>
                        <div style="margin-top: 24px;">
                            <h3 style="margin-bottom: 16px;">Billing History</h3>
                            <div class="table-container">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Date</th>
                                            <th>Description</th>
                                            <th>Amount</th>
                                            <th>Status</th>
                                            <th>Invoice</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Nov 15, 2024</td>
                                            <td>Pro Plan - Monthly Subscription</td>
                                            <td>$99.00</td>
                                            <td><span class="badge badge-success">Paid</span></td>
                                            <td><button class="btn btn-outline btn-small">Download</button></td>
                                        </tr>
                                        <tr>
                                            <td>Oct 15, 2024</td>
                                            <td>Pro Plan - Monthly Subscription</td>
                                            <td>$99.00</td>
                                            <td><span class="badge badge-success">Paid</span></td>
                                            <td><button class="btn btn-outline btn-small">Download</button></td>
                                        </tr>
                                        <tr>
                                            <td>Sep 15, 2024</td>
                                            <td>Pro Plan - Monthly Subscription</td>
                                            <td>$99.00</td>
                                            <td><span class="badge badge-success">Paid</span></td>
                                            <td><button class="btn btn-outline btn-small">Download</button></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    
    <!-- Embed Code Modal -->
    <div class="modal" id="embedModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Embed Chat Widget</h3>
                <button class="modal-close" onclick="hideModal('embedModal')">&times;</button>
            </div>
            <div class="modal-body">
                <p>Add this code to your Squarespace website to embed the chatbot widget:</p>
                
                <div class="embed-code">
                    <div class="code-header">
                        <span>HTML Embed Code</span>
                        <button class="copy-btn" onclick="copyEmbedCode()">
                            <i class="fas fa-copy"></i> Copy
                        </button>
                    </div>
                    <pre id="embedCode">
&lt;!-- STEAMBot Widget --&gt;
&lt;div id="steambot-widget"&gt;&lt;/div&gt;
&lt;script&gt;
  (function() {
    var script = document.createElement('script');
    script.src = 'https://cdn.journeytosteam.com/widget/v1/steambot.js';
    script.async = true;
    script.onload = function() {
      STEAMBot.init({
        businessId: 'journey-to-steam',
        position: 'bottom-right',
        primaryColor: '#2D5AA0',
        accentColor: '#FF6B35'
      });
    };
    document.head.appendChild(script);
  })();
&lt;/script&gt;
&lt;!-- End STEAMBot Widget --&gt;</pre>
                </div>
                
                <div style="margin-top: 20px;">
                    <h4>Installation Instructions:</h4>
                    <ol style="margin-left: 20px; margin-top: 8px;">
                        <li>Log in to your Squarespace dashboard</li>
                        <li>Go to Settings  Advanced  Code Injection</li>
                        <li>Paste the code in the Footer section</li>
                        <li>Save changes</li>
                        <li>The widget will appear on all pages</li>
                    </ol>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="hideModal('embedModal')">Close</button>
                <button class="btn btn-primary" onclick="testEmbed()">Test Embed</button>
            </div>
        </div>
    </div>

    <!-- Add Program Modal -->
    <div class="modal" id="addProgramModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add New Program</h3>
                <button class="modal-close" onclick="hideModal('addProgramModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="programName">Program Name</label>
                    <input type="text" id="programName" placeholder="e.g., Advanced Robotics">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="programAge">Age Range</label>
                        <input type="text" id="programAge" placeholder="e.g., 10-14">
                    </div>
                    <div class="form-group">
                        <label for="programPrice">Price</label>
                        <input type="text" id="programPrice" placeholder="e.g., $140/month">
                    </div>
                </div>
                <div class="form-group">
                    <label for="programSchedule">Schedule</label>
                    <input type="text" id="programSchedule" placeholder="e.g., Tue/Thu 4-5:30 PM">
                </div>
                <div class="form-group">
                    <label for="programDescription">Description</label>
                    <textarea id="programDescription" placeholder="Describe the program content and benefits"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="hideModal('addProgramModal')">Cancel</button>
                <button class="btn btn-primary" onclick="addNewProgram()">Add Program</button>
            </div>
        </div>
    </div>

    <!-- Add FAQ Modal -->
    <div class="modal" id="addFaqModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add New FAQ</h3>
                <button class="modal-close" onclick="hideModal('addFaqModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="faqQuestion">Question</label>
                    <input type="text" id="faqQuestion" placeholder="What parents commonly ask">
                </div>
                <div class="form-group">
                    <label for="faqAnswer">Answer</label>
                    <textarea id="faqAnswer" placeholder="AI's response to this question"></textarea>
                </div>
                <div class="form-group">
                    <label for="faqCategory">Category</label>
                    <select id="faqCategory">
                        <option value="general">General</option>
                        <option value="pricing">Pricing</option>
                        <option value="schedule">Schedule</option>
                        <option value="enrollment">Enrollment</option>
                        <option value="policies">Policies</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="hideModal('addFaqModal')">Cancel</button>
                <button class="btn btn-primary" onclick="addNewFaq()">Add FAQ</button>
            </div>
        </div>
    </div>

    <!-- SMS Test Modal -->
    <div class="modal" id="smsTestModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Send Test SMS</h3>
                <button class="modal-close" onclick="hideModal('smsTestModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="testPhoneNumber">Phone Number</label>
                    <input type="text" id="testPhoneNumber" value="+15551234567" placeholder="+1 (555) 123-4567">
                </div>
                <div class="form-group">
                    <label for="testSmsMessage">Message</label>
                    <textarea id="testSmsMessage" placeholder="Type your test message">Hi, can you tell me about your robotics program?</textarea>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="simulateResponse" checked> Simulate AI response
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="hideModal('smsTestModal')">Cancel</button>
                <button class="btn btn-primary" onclick="sendTestSMS()">Send Test SMS</button>
            </div>
        </div>
    </div>

    <!-- Add Team Member Modal -->
    <div class="modal" id="addTeamMemberModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Team Member</h3>
                <button class="modal-close" onclick="hideModal('addTeamMemberModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-row">
                    <div class="form-group">
                        <label for="memberName">Full Name</label>
                        <input type="text" id="memberName" placeholder="John Doe">
                    </div>
                    <div class="form-group">
                        <label for="memberEmail">Email Address</label>
                        <input type="email" id="memberEmail" placeholder="john@journeytosteam.com">
                    </div>
                </div>
                <div class="form-group">
                    <label for="memberRole">Role</label>
                    <select id="memberRole">
                        <option value="admin">Admin (Full Access)</option>
                        <option value="manager">Manager (View & Edit)</option>
                        <option value="agent">Support Agent (View Only)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="sendInvite" checked> Send invitation email
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="hideModal('addTeamMemberModal')">Cancel</button>
                <button class="btn btn-primary" onclick="addTeamMember()">Add Team Member</button>
            </div>
        </div>
    </div>

    <!-- Knowledge Update Modal -->
    <div class="modal" id="knowledgeModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Update Knowledge Base</h3>
                <button class="modal-close" onclick="hideModal('knowledgeModal')">&times;</button>
            </div>
            <div class="modal-body">
                <p>This will update the AI's knowledge base with the latest program information, pricing, and policies.</p>
                <div class="form-group">
                    <label for="updateNotes">Update Notes</label>
                    <textarea id="updateNotes" placeholder="Describe what you're updating..."></textarea>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="trainAi" checked> Train AI with updated information
                    </label>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="clearCache" checked> Clear conversation cache
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="hideModal('knowledgeModal')">Cancel</button>
                <button class="btn btn-primary" onclick="updateKnowledgeBase()">Update Knowledge Base</button>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // APPLICATION STATE AND DATA
        // ============================================
        
        const AppState = {
            currentPage: 'dashboard',
            conversations: [],
            leads: [],
            programs: [
                {
                    id: 'robotics',
                    name: 'Robotics Engineering',
                    age: '8-12 years',
                    price: '$120/month',
                    schedule: 'Mon/Wed 4-5:30 PM',
                    description: 'Build and program robots using LEGO Mindstorms and VEX robotics kits'
                },
                {
                    id: 'coding',
                    name: 'Coding & Game Development',
                    age: '10-14 years',
                    price: '$110/month',
                    schedule: 'Tue/Thu 4-5:30 PM',
                    description: 'Learn Python, Scratch, and game design principles'
                },
                {
                    id: 'science',
                    name: 'Science Experiments',
                    age: '6-10 years',
                    price: '$100/month',
                    schedule: 'Sat 9-11 AM',
                    description: 'Hands-on experiments in chemistry, physics, and biology'
                },
                {
                    id: 'math',
                    name: 'Math Enrichment',
                    age: '7-12 years',
                    price: '$90/month',
                    schedule: 'Fri 4-5:30 PM',
                    description: 'Advanced math concepts through puzzles and games'
                }
            ],
            faqs: [
                {
                    question: 'What ages do you serve?',
                    answer: 'We serve children ages 6-14 with age-appropriate programs for each level.',
                    category: 'general'
                },
                {
                    question: 'Do you offer trial classes?',
                    answer: 'Yes! We offer one free trial class for all new students. Contact us to schedule.',
                    category: 'enrollment'
                },
                {
                    question: 'What is your cancellation policy?',
                    answer: 'Cancellations require 24-hour notice for rescheduling. No refunds for missed classes.',
                    category: 'policies'
                },
                {
                    question: 'Are materials provided?',
                    answer: 'All materials are provided for in-class activities. Students need only bring enthusiasm!',
                    category: 'general'
                },
                {
                    question: 'What if my child misses a class?',
                    answer: 'We offer one make-up class per month with advance notice.',
                    category: 'policies'
                }
            ],
            teamMembers: [
                { name: 'Alex Johnson', email: 'alex@journeytosteam.com', role: 'admin', lastActive: 'Today' },
                { name: 'Maria Garcia', email: 'maria@journeytosteam.com', role: 'manager', lastActive: 'Yesterday' },
                { name: 'David Chen', email: 'david@journeytosteam.com', role: 'agent', lastActive: '2 days ago' }
            ],
            smsConversations: []
        };

        // ============================================
        // INITIALIZATION
        // ============================================

        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            generateSampleData();
            loadDashboardData();
            loadConversations();
            loadPrograms();
            loadFAQs();
            loadTeamMembers();
            loadSMSConversations();
            
            // Set up navigation
            setupNavigation();
            
            // Set up settings menu
            setupSettingsMenu();
            
            // Show dashboard by default
            navigateTo('dashboard');
        });

        function initializeApp() {
            // Initialize toast container
            window.toastContainer = document.getElementById('toastContainer');
            
            // Set up modal close handlers
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        this.classList.remove('active');
                    }
                });
            });
        }

        // ============================================
        // NAVIGATION
        // ============================================

        function setupNavigation() {
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const page = this.getAttribute('data-page');
                    navigateTo(page);
                });
            });
            
            // Logo navigation
            document.querySelector('.logo').addEventListener('click', function(e) {
                e.preventDefault();
                navigateTo('dashboard');
            });
        }

        function navigateTo(page) {
            // Update active nav link
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('data-page') === page) {
                    link.classList.add('active');
                }
            });
            
            // Hide all pages
            document.querySelectorAll('.page').forEach(pageEl => {
                pageEl.classList.remove('active');
            });
            
            // Show selected page
            const pageEl = document.getElementById(`page-${page}`);
            if (pageEl) {
                pageEl.classList.add('active');
                AppState.currentPage = page;
                
                // Update page title
                document.title = `STEAMBot - ${page.charAt(0).toUpperCase() + page.slice(1)}`;
                
                // Refresh page-specific data
                switch(page) {
                    case 'conversations':
                        loadConversations();
                        break;
                    case 'analytics':
                        updateAnalytics();
                        break;
                }
            }
        }

        // ============================================
        // MODAL FUNCTIONS
        // ============================================

        function showModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }

        function hideModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // ============================================
        // TOAST NOTIFICATIONS
        // ============================================

        function showToast(message, type = 'info', duration = 5000) {
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            
            const icon = type === 'success' ? '' : 
                        type === 'error' ? '' : 
                        type === 'warning' ? '' : '';
            
            toast.innerHTML = `
                <div class="toast-icon">${icon}</div>
                <div class="toast-content">
                    <h4>${type.charAt(0).toUpperCase() + type.slice(1)}</h4>
                    <p>${message}</p>
                </div>
                <button class="toast-close" onclick="this.parentElement.remove()">&times;</button>
            `;
            
            window.toastContainer.appendChild(toast);
            
            // Auto-remove after duration
            setTimeout(() => {
                if (toast.parentElement) {
                    toast.remove();
                }
            }, duration);
        }

        // ============================================
        // DASHBOARD FUNCTIONS
        // ============================================

        function loadDashboardData() {
            // Update stats with random variations
            const conversations = Math.floor(40 + Math.random() * 15);
            const leads = Math.floor(12 + Math.random() * 8);
            
            document.getElementById('statConversations').textContent = conversations;
            document.getElementById('statLeads').textContent = leads;
            
            // Load recent conversations
            loadRecentConversations();
        }

        function loadRecentConversations() {
            const tbody = document.getElementById('recentConversations');
            tbody.innerHTML = '';
            
            const recent = AppState.conversations.slice(0, 5);
            
            recent.forEach(conv => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${conv.time}</td>
                    <td>${conv.parent}</td>
                    <td>${conv.message.substring(0, 50)}${conv.message.length > 50 ? '...' : ''}</td>
                    <td><span class="badge ${conv.status === 'active' ? 'badge-success' : conv.status === 'escalated' ? 'badge-warning' : 'badge-info'}">${conv.status}</span></td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn btn-outline btn-small" onclick="viewConversation('${conv.id}')">View</button>
                            ${conv.status === 'active' ? `<button class="btn btn-primary btn-small" onclick="assignConversation('${conv.id}')">Assign</button>` : ''}
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
            
            if (recent.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="5" style="text-align: center; padding: 40px; color: var(--gray);">
                            <i class="fas fa-comments" style="font-size: 32px; margin-bottom: 16px; display: block;"></i>
                            No conversations yet
                        </td>
                    </tr>
                `;
            }
        }

        function sendDashboardMessage() {
            const input = document.getElementById('dashboardInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            const chat = document.getElementById('dashboardChat');
            
            // Add user message
            const userMsg = document.createElement('div');
            userMsg.className = 'chat-message message-user';
            userMsg.textContent = message;
            chat.appendChild(userMsg);
            
            // Clear input
            input.value = '';
            
            // Show typing indicator
            const typing = document.createElement('div');
            typing.className = 'typing-indicator';
            typing.innerHTML = '<span></span><span></span><span></span>';
            chat.appendChild(typing);
            
            // Simulate AI response
            setTimeout(() => {
                typing.remove();
                
                const responses = [
                    "I'd be happy to help with that! Our programs are designed for different age groups and skill levels.",
                    "Great question! Let me provide you with the information you need about our STEAM programs.",
                    "Thanks for asking! I can help you with program details, schedules, and pricing information.",
                    "I understand you're looking for information. Let me give you the details you need."
                ];
                
                const response = responses[Math.floor(Math.random() * responses.length)];
                
                const aiMsg = document.createElement('div');
                aiMsg.className = 'chat-message message-assistant';
                aiMsg.textContent = response;
                chat.appendChild(aiMsg);
                
                chat.scrollTop = chat.scrollHeight;
            }, 1500);
        }

        function captureQuickLead() {
            const name = document.getElementById('quickName').value.trim();
            const email = document.getElementById('quickEmail').value.trim();
            const program = document.getElementById('quickProgram').value;
            
            if (!name || !email || !program) {
                showToast('Please fill all fields', 'warning');
                return;
            }
            
            // Add to leads
            AppState.leads.push({
                id: 'lead-' + Date.now(),
                name,
                email,
                program,
                date: new Date().toLocaleDateString(),
                status: 'new'
            });
            
            // Update stats
            const leadCount = parseInt(document.getElementById('statLeads').textContent);
            document.getElementById('statLeads').textContent = leadCount + 1;
            
            // Clear form
            document.getElementById('quickName').value = '';
            document.getElementById('quickEmail').value = '';
            document.getElementById('quickProgram').value = '';
            
            showToast(`Lead captured: ${name}`, 'success');
            
            // Simulate CSV export
            setTimeout(() => {
                const csvContent = `data:text/csv;charset=utf-8,Name,Email,Program,Date\n${name},${email},${program},${new Date().toISOString()}`;
                const encodedUri = encodeURI(csvContent);
                const link = document.createElement('a');
                link.setAttribute('href', encodedUri);
                link.setAttribute('download', `lead_${Date.now()}.csv`);
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                showToast('Lead exported to CSV', 'info');
            }, 500);
        }

        // ============================================
        // CHAT FUNCTIONS
        // ============================================

        function sendLiveChatMessage() {
            const input = document.getElementById('liveChatInput');
            const button = document.getElementById('liveChatButton');
            const message = input.value.trim();
            
            if (!message) return;
            
            const chat = document.getElementById('liveChat');
            
            // Add user message
            const userMsg = document.createElement('div');
            userMsg.className = 'chat-message message-user';
            userMsg.textContent = message;
            chat.appendChild(userMsg);
            
            // Clear and disable input
            input.value = '';
            input.disabled = true;
            button.disabled = true;
            button.innerHTML = '<div class="loading"></div>';
            
            // Show typing indicator
            const typing = document.createElement('div');
            typing.className = 'typing-indicator';
            typing.innerHTML = '<span></span><span></span><span></span>';
            chat.appendChild(typing);
            chat.scrollTop = chat.scrollHeight;
            
            // Generate AI response
            setTimeout(() => {
                typing.remove();
                
                const response = generateAIResponse(message);
                
                const aiMsg = document.createElement('div');
                aiMsg.className = 'chat-message message-assistant';
                aiMsg.textContent = response;
                chat.appendChild(aiMsg);
                
                // Re-enable input
                input.disabled = false;
                button.disabled = false;
                button.innerHTML = 'Send <i class="fas fa-paper-plane"></i>';
                input.focus();
                
                chat.scrollTop = chat.scrollHeight;
                
                // Log conversation
                logConversation(message, response, 'web');
                
                showToast('Message sent', 'success');
            }, 1500 + Math.random() * 1000);
        }

        function quickQuestion(question) {
            document.getElementById('liveChatInput').value = question;
            sendLiveChatMessage();
        }

        function resetChat() {
            const chat = document.getElementById('liveChat');
            chat.innerHTML = `
                <div class="chat-message message-system">
                    <i class="fas fa-info-circle"></i> Welcome to STEAMBot! I can help with program information, schedules, pricing, and policies. I'm designed to assist but will escalate to human support when needed.
                </div>
                <div class="chat-message message-assistant">
                    Hello! I'm STEAMBot, your AI assistant for Journey to STEAM. I can help answer questions about our programs, schedule, pricing, and enrollment process. What would you like to know?
                </div>
            `;
            showToast('Chat reset', 'info');
        }

        function generateAIResponse(message) {
            const msg = message.toLowerCase();
            
            // Guardrail checks
            if (msg.includes('enroll') || msg.includes('sign up') || msg.includes('register') || msg.includes('signup')) {
                return "I can provide information about our programs and schedule. To enroll, please visit our website at journeytosteam.com/register or call us at (555) 123-4567 for assistance with the enrollment process.";
            }
            
            if (msg.includes('pay') || msg.includes('payment') || msg.includes('credit card') || msg.includes('cash')) {
                return "I can share our pricing information. For payment processing and registration, please visit our secure portal at journeytosteam.com/enroll or contact our office for assistance with billing questions.";
            }
            
            if (msg.includes('sick') || msg.includes('medicine') || msg.includes('allergy') || msg.includes('health')) {
                return "For any medical concerns, allergies, or health-related questions, please contact our center director directly at (555) 123-4567. They can provide appropriate guidance for your child's specific needs and our safety protocols.";
            }
            
            if (msg.includes('human') || msg.includes('speak to') || msg.includes('talk to')) {
                return "I'm connecting you with our team. Please call (555) 123-4567 or email info@journeytosteam.com for immediate assistance. Our office hours are Monday-Friday 9AM-5PM.";
            }
            
            // Program-specific responses
            if (msg.includes('robot')) {
                const program = AppState.programs.find(p => p.id === 'robotics');
                return `${program.name}:\n Ages: ${program.age}\n Price: ${program.price}\n Schedule: ${program.schedule}\n Description: ${program.description}\n\nWould you like information about a free trial class?`;
            }
            
            if (msg.includes('code') || msg.includes('programming')) {
                const program = AppState.programs.find(p => p.id === 'coding');
                return `${program.name}:\n Ages: ${program.age}\n Price: ${program.price}\n Schedule: ${program.schedule}\n Description: ${program.description}\n\nWe start with block coding for beginners and progress to Python.`;
            }
            
            if (msg.includes('science') || msg.includes('experiment')) {
                const program = AppState.programs.find(p => p.id === 'science');
                return `${program.name}:\n Ages: ${program.age}\n Price: ${program.price}\n Schedule: ${program.schedule}\n Description: ${program.description}\n\nAll experiments are safe and supervised by certified instructors.`;
            }
            
            if (msg.includes('math')) {
                const program = AppState.programs.find(p => p.id === 'math');
                return `${program.name}:\n Ages: ${program.age}\n Price: ${program.price}\n Schedule: ${program.schedule}\n Description: ${program.description}\n\nWe make math fun through games and real-world applications.`;
            }
            
            // FAQ responses
            if (msg.includes('age') || msg.includes('old')) {
                return "We serve children ages 6-14. Our programs are grouped by age and skill level:\n Ages 6-10: Science Experiments, Math Enrichment\n Ages 8-12: Robotics Engineering\n Ages 10-14: Coding & Game Development\n\nWhich age group are you interested in?";
            }
            
            if (msg.includes('cost') || msg.includes('price') || msg.includes('how much')) {
                let response = "Our programs range from $90-$120 per month:\n";
                AppState.programs.forEach(p => {
                    response += ` ${p.name}: ${p.price}\n`;
                });
                response += "\nAll prices include materials. Financial assistance may be available.";
                return response;
            }
            
            if (msg.includes('time') || msg.includes('hour') || msg.includes('schedule')) {
                return "Our regular class hours are:\nWeekdays: 3-6 PM\nSaturdays: 9 AM-12 PM\n\nSpecific program schedules are listed on our website. We also offer after-school pickup from local schools.";
            }
            
            if (msg.includes('location') || msg.includes('address') || msg.includes('where')) {
                return "We're located at:\n123 Innovation Drive\nTech City, STEAM 12345\n\nParking is available in the rear lot. We're easily accessible from downtown and have secure facilities.";
            }
            
            if (msg.includes('trial') || msg.includes('free class')) {
                return "Yes! We offer one free trial class for all new students. You can schedule a trial by:\n1. Calling us at (555) 123-4567\n2. Emailing info@journeytosteam.com\n3. Using our online scheduler at journeytosteam.com/trial\n\nWhich program would you like to try?";
            }
            
            // Default response
            const defaultResponses = [
                "I understand you're asking about: \"" + message + "\". I want to make sure I give you accurate information. Could you provide more details about what you're looking for?",
                "Thanks for your question! I can help with program information, schedules, pricing, and policies. Could you tell me more about what specifically you'd like to know?",
                "I'd be happy to help! To give you the best information, could you let me know if you're interested in a specific program or age group?",
                "That's a great question! I can provide information about our STEAM programs. Are you looking for details about a particular program like Robotics or Coding?"
            ];
            
            return defaultResponses[Math.floor(Math.random() * defaultResponses.length)];
        }

        function logConversation(userMessage, aiResponse, channel) {
            const conversation = {
                id: 'conv-' + Date.now(),
                parent: 'Parent ' + Math.floor(Math.random() * 1000),
                message: userMessage,
                response: aiResponse,
                time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
                date: new Date().toLocaleDateString(),
                channel: channel,
                status: Math.random() > 0.7 ? 'escalated' : 'completed',
                leadCaptured: Math.random() > 0.5
            };
            
            AppState.conversations.unshift(conversation);
            
            // Update dashboard if needed
            if (AppState.currentPage === 'dashboard') {
                loadRecentConversations();
            }
            
            // Update conversations page if active
            if (AppState.currentPage === 'conversations') {
                loadConversations();
            }
        }

        // ============================================
        // CONVERSATIONS PAGE
        // ============================================

        function loadConversations() {
            const tbody = document.getElementById('allConversations');
            tbody.innerHTML = '';
            
            AppState.conversations.forEach(conv => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${conv.id}</td>
                    <td>${conv.date} ${conv.time}</td>
                    <td>${conv.parent}</td>
                    <td><span class="badge ${conv.channel === 'web' ? 'badge-info' : 'badge-success'}">${conv.channel.toUpperCase()}</span></td>
                    <td>${conv.message.substring(0, 40)}${conv.message.length > 40 ? '...' : ''}</td>
                    <td><span class="badge ${conv.status === 'active' ? 'badge-success' : conv.status === 'escalated' ? 'badge-warning' : 'badge-info'}">${conv.status}</span></td>
                    <td>${conv.leadCaptured ? '<span class="badge badge-success">Yes</span>' : '<span class="badge">No</span>'}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn btn-outline btn-small" onclick="viewConversation('${conv.id}')">View</button>
                            <button class="btn btn-outline btn-small" onclick="deleteConversation('${conv.id}')">Delete</button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
            
            if (AppState.conversations.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="8" style="text-align: center; padding: 40px; color: var(--gray);">
                            <i class="fas fa-comments" style="font-size: 32px; margin-bottom: 16px; display: block;"></i>
                            No conversations yet. Test the chat to see conversations here.
                        </td>
                    </tr>
                `;
            }
        }

        function filterConversations() {
            const dateFilter = document.getElementById('filterDate').value;
            const channelFilter = document.getElementById('filterChannel').value;
            const statusFilter = document.getElementById('filterStatus').value;
            const searchFilter = document.getElementById('searchConversations').value.toLowerCase();
            
            // In a real app, this would filter the data
            // For now, we'll just show a toast
            showToast(`Filtering conversations: ${dateFilter}, ${channelFilter}, ${statusFilter}`, 'info');
        }

        function viewConversation(id) {
            const conv = AppState.conversations.find(c => c.id === id);
            if (conv) {
                alert(`Conversation Details\n\nID: ${conv.id}\nParent: ${conv.parent}\nTime: ${conv.date} ${conv.time}\nChannel: ${conv.channel}\nStatus: ${conv.status}\n\nUser: ${conv.message}\n\nAI: ${conv.response}\n\nLead Captured: ${conv.leadCaptured ? 'Yes' : 'No'}`);
            }
        }

        function deleteConversation(id) {
            if (confirm('Are you sure you want to delete this conversation?')) {
                AppState.conversations = AppState.conversations.filter(c => c.id !== id);
                loadConversations();
                showToast('Conversation deleted', 'success');
            }
        }

        function exportConversations() {
            // Simulate CSV export
            const headers = ['ID', 'Date', 'Time', 'Parent', 'Channel', 'Message', 'Response', 'Status', 'Lead Captured'];
            const rows = AppState.conversations.map(c => [
                c.id,
                c.date,
                c.time,
                c.parent,
                c.channel,
                c.message,
                c.response,
                c.status,
                c.leadCaptured ? 'Yes' : 'No'
            ]);
            
            const csvContent = 'data:text/csv;charset=utf-8,' 
                + [headers, ...rows].map(e => e.join(',')).join('\n');
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement('a');
            link.setAttribute('href', encodedUri);
            link.setAttribute('download', `conversations_${new Date().toISOString().split('T')[0]}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showToast(`Exported ${AppState.conversations.length} conversations to CSV`, 'success');
        }

        function loadMoreConversations() {
            // Simulate loading more data
            for (let i = 0; i < 5; i++) {
                const conv = {
                    id: 'conv-' + (Date.now() + i),
                    parent: 'Parent ' + Math.floor(Math.random() * 1000),
                    message: ['What programs do you have?', 'How much does it cost?', 'What are your hours?', 'Do you offer trials?', 'Where are you located?'][Math.floor(Math.random() * 5)],
                    response: 'AI response would be here',
                    time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
                    date: new Date().toLocaleDateString(),
                    channel: Math.random() > 0.5 ? 'web' : 'sms',
                    status: ['completed', 'escalated', 'active'][Math.floor(Math.random() * 3)],
                    leadCaptured: Math.random() > 0.5
                };
                AppState.conversations.push(conv);
            }
            
            loadConversations();
            showToast('Loaded 5 more conversations', 'info');
        }

        function refreshConversations() {
            loadConversations();
            showToast('Conversations refreshed', 'success');
        }

        // ============================================
        // KNOWLEDGE BASE FUNCTIONS
        // ============================================

        function loadPrograms() {
            const grid = document.getElementById('programsGrid');
            grid.innerHTML = '';
            
            AppState.programs.forEach(program => {
                const card = document.createElement('div');
                card.className = 'knowledge-card';
                card.innerHTML = `
                    <div class="knowledge-card-header">
                        <h3><i class="fas fa-graduation-cap"></i> ${program.name}</h3>
                    </div>
                    <div class="knowledge-card-content">
                        <div class="knowledge-item">
                            <strong>Age Range</strong>
                            <p>${program.age}</p>
                        </div>
                        <div class="knowledge-item">
                            <strong>Price</strong>
                            <p>${program.price}</p>
                        </div>
                        <div class="knowledge-item">
                            <strong>Schedule</strong>
                            <p>${program.schedule}</p>
                        </div>
                        <div class="knowledge-item">
                            <strong>Description</strong>
                            <p>${program.description}</p>
                        </div>
                        <div style="margin-top: 16px; display: flex; gap: 8px;">
                            <button class="btn btn-outline btn-small" onclick="editProgram('${program.id}')">Edit</button>
                            <button class="btn btn-outline btn-small" onclick="deleteProgram('${program.id}')">Delete</button>
                        </div>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        function loadFAQs() {
            const tbody = document.getElementById('faqsTable');
            tbody.innerHTML = '';
            
            AppState.faqs.forEach((faq, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${faq.question}</td>
                    <td>${faq.answer.substring(0, 60)}${faq.answer.length > 60 ? '...' : ''}</td>
                    <td><span class="badge badge-info">${faq.category}</span></td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn btn-outline btn-small" onclick="editFAQ(${index})">Edit</button>
                            <button class="btn btn-outline btn-small" onclick="deleteFAQ(${index})">Delete</button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function addNewProgram() {
            const name = document.getElementById('programName').value.trim();
            const age = document.getElementById('programAge').value.trim();
            const price = document.getElementById('programPrice').value.trim();
            const schedule = document.getElementById('programSchedule').value.trim();
            const description = document.getElementById('programDescription').value.trim();
            
            if (!name || !age || !price || !schedule || !description) {
                showToast('Please fill all fields', 'warning');
                return;
            }
            
            const newProgram = {
                id: 'prog-' + Date.now(),
                name,
                age,
                price,
                schedule,
                description
            };
            
            AppState.programs.push(newProgram);
            loadPrograms();
            hideModal('addProgramModal');
            showToast(`Program "${name}" added to knowledge base`, 'success');
            
            // Clear form
            document.getElementById('programName').value = '';
            document.getElementById('programAge').value = '';
            document.getElementById('programPrice').value = '';
            document.getElementById('programSchedule').value = '';
            document.getElementById('programDescription').value = '';
        }

        function addNewFaq() {
            const question = document.getElementById('faqQuestion').value.trim();
            const answer = document.getElementById('faqAnswer').value.trim();
            const category = document.getElementById('faqCategory').value;
            
            if (!question || !answer) {
                showToast('Please fill all fields', 'warning');
                return;
            }
            
            AppState.faqs.push({
                question,
                answer,
                category
            });
            
            loadFAQs();
            hideModal('addFaqModal');
            showToast('FAQ added to knowledge base', 'success');
            
            // Clear form
            document.getElementById('faqQuestion').value = '';
            document.getElementById('faqAnswer').value = '';
            document.getElementById('faqCategory').value = 'general';
        }

        function editProgram(id) {
            const program = AppState.programs.find(p => p.id === id);
            if (program) {
                document.getElementById('programName').value = program.name;
                document.getElementById('programAge').value = program.age;
                document.getElementById('programPrice').value = program.price;
                document.getElementById('programSchedule').value = program.schedule;
                document.getElementById('programDescription').value = program.description;
                
                showModal('addProgramModal');
                
                // Change button text
                const button = document.querySelector('#addProgramModal .btn-primary');
                button.textContent = 'Update Program';
                button.onclick = function() {
                    updateProgram(id);
                };
            }
        }

        function updateProgram(id) {
            const name = document.getElementById('programName').value.trim();
            const age = document.getElementById('programAge').value.trim();
            const price = document.getElementById('programPrice').value.trim();
            const schedule = document.getElementById('programSchedule').value.trim();
            const description = document.getElementById('programDescription').value.trim();
            
            if (!name || !age || !price || !schedule || !description) {
                showToast('Please fill all fields', 'warning');
                return;
            }
            
            const index = AppState.programs.findIndex(p => p.id === id);
            if (index !== -1) {
                AppState.programs[index] = {
                    id,
                    name,
                    age,
                    price,
                    schedule,
                    description
                };
                
                loadPrograms();
                hideModal('addProgramModal');
                showToast(`Program "${name}" updated`, 'success');
                
                // Reset button
                const button = document.querySelector('#addProgramModal .btn-primary');
                button.textContent = 'Add Program';
                button.onclick = addNewProgram;
                
                // Clear form
                document.getElementById('programName').value = '';
                document.getElementById('programAge').value = '';
                document.getElementById('programPrice').value = '';
                document.getElementById('programSchedule').value = '';
                document.getElementById('programDescription').value = '';
            }
        }

        function deleteProgram(id) {
            if (confirm('Are you sure you want to delete this program?')) {
                AppState.programs = AppState.programs.filter(p => p.id !== id);
                loadPrograms();
                showToast('Program deleted from knowledge base', 'success');
            }
        }

        function editFAQ(index) {
            const faq = AppState.faqs[index];
            if (faq) {
                document.getElementById('faqQuestion').value = faq.question;
                document.getElementById('faqAnswer').value = faq.answer;
                document.getElementById('faqCategory').value = faq.category;
                
                showModal('addFaqModal');
                
                // Change button text
                const button = document.querySelector('#addFaqModal .btn-primary');
                button.textContent = 'Update FAQ';
                button.onclick = function() {
                    updateFAQ(index);
                };
            }
        }

        function updateFAQ(index) {
            const question = document.getElementById('faqQuestion').value.trim();
            const answer = document.getElementById('faqAnswer').value.trim();
            const category = document.getElementById('faqCategory').value;
            
            if (!question || !answer) {
                showToast('Please fill all fields', 'warning');
                return;
            }
            
            AppState.faqs[index] = {
                question,
                answer,
                category
            };
            
            loadFAQs();
            hideModal('addFaqModal');
            showToast('FAQ updated', 'success');
            
            // Reset button
            const button = document.querySelector('#addFaqModal .btn-primary');
            button.textContent = 'Add FAQ';
            button.onclick = addNewFaq;
            
            // Clear form
            document.getElementById('faqQuestion').value = '';
            document.getElementById('faqAnswer').value = '';
            document.getElementById('faqCategory').value = 'general';
        }

        function deleteFAQ(index) {
            if (confirm('Are you sure you want to delete this FAQ?')) {
                AppState.faqs.splice(index, 1);
                loadFAQs();
                showToast('FAQ deleted from knowledge base', 'success');
            }
        }

        function updateKnowledgeBase() {
            const notes = document.getElementById('updateNotes').value;
            const trainAi = document.getElementById('trainAi').checked;
            const clearCache = document.getElementById('clearCache').checked;
            
            // Simulate API call
            setTimeout(() => {
                hideModal('knowledgeModal');
                showToast('Knowledge base updated successfully! AI has been retrained.', 'success');
                
                // Clear form
                document.getElementById('updateNotes').value = '';
            }, 2000);
        }

        // ============================================
        // SMS FUNCTIONS
        // ============================================

        function loadSMSConversations() {
            const tbody = document.getElementById('smsConversations');
            tbody.innerHTML = '';
            
            AppState.smsConversations.forEach(sms => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${sms.phone}</td>
                    <td>${sms.message.substring(0, 40)}${sms.message.length > 40 ? '...' : ''}</td>
                    <td>${sms.time}</td>
                    <td><span class="badge ${sms.status === 'delivered' ? 'badge-success' : sms.status === 'failed' ? 'badge-danger' : 'badge-warning'}">${sms.status}</span></td>
                    <td>${sms.lead ? '<span class="badge badge-success">Captured</span>' : '<span class="badge">No</span>'}</td>
                    <td>
                        <button class="btn btn-outline btn-small" onclick="viewSMS('${sms.id}')">View</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
            
            if (AppState.smsConversations.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="6" style="text-align: center; padding: 40px; color: var(--gray);">
                            <i class="fas fa-sms" style="font-size: 32px; margin-bottom: 16px; display: block;"></i>
                            No SMS conversations yet
                        </td>
                    </tr>
                `;
            }
        }

        function sendTestSMS() {
            const phone = document.getElementById('testPhoneNumber').value.trim();
            const message = document.getElementById('testSmsMessage').value.trim();
            const simulateResponse = document.getElementById('simulateResponse')?.checked || true;
            
            if (!phone || !message) {
                showToast('Please fill all fields', 'warning');
                return;
            }
            
            // Add to SMS conversations
            const sms = {
                id: 'sms-' + Date.now(),
                phone,
                message,
                time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
                status: 'delivered',
                lead: Math.random() > 0.5
            };
            
            AppState.smsConversations.unshift(sms);
            loadSMSConversations();
            
            hideModal('smsTestModal');
            showToast(`Test SMS sent to ${phone}`, 'success');
            
            // Simulate AI response
            if (simulateResponse) {
                setTimeout(() => {
                    const response = "Thanks for your message! This is a simulated AI response. In production, the AI would respond based on your question.";
                    
                    const responseSms = {
                        id: 'sms-' + Date.now(),
                        phone: 'STEAMBot',
                        message: response,
                        time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
                        status: 'delivered',
                        lead: false
                    };
                    
                    AppState.smsConversations.unshift(responseSms);
                    loadSMSConversations();
                    
                    showToast('AI responded to SMS', 'info');
                }, 3000);
            }
        }

        function viewSMS(id) {
            const sms = AppState.smsConversations.find(s => s.id === id);
            if (sms) {
                alert(`SMS Details\n\nTo: ${sms.phone}\nTime: ${sms.time}\nStatus: ${sms.status}\n\nMessage: ${sms.message}\n\nLead Captured: ${sms.lead ? 'Yes' : 'No'}`);
            }
        }

        function updateSmsNumber() {
            const newNumber = prompt('Enter new Twilio phone number:', '+15551234567');
            if (newNumber) {
                showToast(`SMS number updated to ${newNumber}`, 'success');
            }
        }

        function exportSmsLogs() {
            showToast('SMS logs exported to CSV', 'success');
        }

        function testSmsDelivery() {
            showToast('SMS delivery test initiated. Check logs for results.', 'info');
        }

        // ============================================
        // ANALYTICS FUNCTIONS
        // ============================================

        function updateAnalytics() {
            const period = document.getElementById('analyticsPeriod').value;
            showToast(`Analytics updated for last ${period} days`, 'info');
        }

        // ============================================
        // SETTINGS FUNCTIONS
        // ============================================

        function setupSettingsMenu() {
            document.querySelectorAll('.settings-menu-item').forEach(item => {
                item.addEventListener('click', function() {
                    const settings = this.getAttribute('data-settings');
                    
                    // Update active menu item
                    document.querySelectorAll('.settings-menu-item').forEach(i => {
                        i.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // Show selected settings section
                    document.querySelectorAll('.settings-section').forEach(section => {
                        section.classList.remove('active');
                    });
                    document.getElementById(`settings-${settings}`).classList.add('active');
                });
            });
        }

        function saveSettings(type) {
            showToast(`${type.charAt(0).toUpperCase() + type.slice(1)} settings saved`, 'success');
        }

        function loadTeamMembers() {
            const tbody = document.getElementById('teamMembers');
            tbody.innerHTML = '';
            
            AppState.teamMembers.forEach(member => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${member.name}</td>
                    <td>${member.email}</td>
                    <td><span class="badge ${member.role === 'admin' ? 'badge-danger' : member.role === 'manager' ? 'badge-warning' : 'badge-info'}">${member.role}</span></td>
                    <td>${member.lastActive}</td>
                    <td>
                        <button class="btn btn-outline btn-small" onclick="editTeamMember('${member.email}')">Edit</button>
                        <button class="btn btn-outline btn-small" onclick="removeTeamMember('${member.email}')">Remove</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function addTeamMember() {
            const name = document.getElementById('memberName').value.trim();
            const email = document.getElementById('memberEmail').value.trim();
            const role = document.getElementById('memberRole').value;
            const sendInvite = document.getElementById('sendInvite').checked;
            
            if (!name || !email) {
                showToast('Please fill all fields', 'warning');
                return;
            }
            
            AppState.teamMembers.push({
                name,
                email,
                role,
                lastActive: 'Just now'
            });
            
            loadTeamMembers();
            hideModal('addTeamMemberModal');
            showToast(`Team member ${name} added`, 'success');
            
            if (sendInvite) {
                showToast('Invitation email sent', 'info');
            }
            
            // Clear form
            document.getElementById('memberName').value = '';
            document.getElementById('memberEmail').value = '';
            document.getElementById('memberRole').value = 'admin';
            document.getElementById('sendInvite').checked = true;
        }

        function editTeamMember(email) {
            const member = AppState.teamMembers.find(m => m.email === email);
            if (member) {
                alert(`Edit team member ${member.name}\n\nEmail: ${member.email}\nRole: ${member.role}\n\nEdit functionality would open a modal in production.`);
            }
        }

        function removeTeamMember(email) {
            if (confirm('Are you sure you want to remove this team member?')) {
                AppState.teamMembers = AppState.teamMembers.filter(m => m.email !== email);
                loadTeamMembers();
                showToast('Team member removed', 'success');
            }
        }

        // ============================================
        // UTILITY FUNCTIONS
        // ============================================

        function exportData(type) {
            if (type === 'leads') {
                if (AppState.leads.length === 0) {
                    showToast('No leads to export', 'warning');
                    return;
                }
                
                const csvContent = 'data:text/csv;charset=utf-8,Name,Email,Program,Date,Status\n' 
                    + AppState.leads.map(l => `${l.name},${l.email},${l.program},${l.date},${l.status}`).join('\n');
                
                const encodedUri = encodeURI(csvContent);
                const link = document.createElement('a');
                link.setAttribute('href', encodedUri);
                link.setAttribute('download', `leads_${new Date().toISOString().split('T')[0]}.csv`);
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                showToast(`Exported ${AppState.leads.length} leads to CSV`, 'success');
            } else if (type === 'conversations') {
                exportConversations();
            }
        }

        function copyEmbedCode() {
            const code = document.getElementById('embedCode').textContent;
            navigator.clipboard.writeText(code).then(() => {
                showToast('Embed code copied to clipboard', 'success');
            });
        }

        function testEmbed() {
            showToast('Embed test initiated. Check your website for the widget.', 'info');
        }

        function assignConversation(id) {
            showToast(`Conversation ${id} assigned to you`, 'success');
        }

        // ============================================
        // SAMPLE DATA GENERATION
        // ============================================

        function generateSampleData() {
            // Generate sample conversations
            const sampleMessages = [
                'What programs do you offer?',
                'How much does robotics cost?',
                'What are your hours?',
                'Do you offer trial classes?',
                'Where are you located?',
                'Can I enroll my 7 year old?',
                'What is the cancellation policy?',
                'Do you provide materials?',
                'What age groups do you serve?',
                'Is there a sibling discount?'
            ];
            
            const sampleParents = ['Sarah Johnson', 'Mike Chen', 'Jessica Williams', 'David Brown', 'Maria Garcia', 'Robert Smith', 'Jennifer Lee', 'James Wilson', 'Lisa Martinez', 'Thomas Taylor'];
            
            for (let i = 0; i < 15; i++) {
                const daysAgo = Math.floor(Math.random() * 30);
                const date = new Date();
                date.setDate(date.getDate() - daysAgo);
                
                AppState.conversations.push({
                    id: 'conv-' + (1000 + i),
                    parent: sampleParents[Math.floor(Math.random() * sampleParents.length)],
                    message: sampleMessages[Math.floor(Math.random() * sampleMessages.length)],
                    response: 'Sample AI response would be here',
                    time: `${Math.floor(Math.random() * 12) + 1}:${Math.floor(Math.random() * 60).toString().padStart(2, '0')} ${Math.random() > 0.5 ? 'AM' : 'PM'}`,
                    date: date.toLocaleDateString(),
                    channel: Math.random() > 0.5 ? 'web' : 'sms',
                    status: ['completed', 'escalated', 'active'][Math.floor(Math.random() * 3)],
                    leadCaptured: Math.random() > 0.5
                });
            }
            
            // Generate sample SMS conversations
            for (let i = 0; i < 8; i++) {
                AppState.smsConversations.push({
                    id: 'sms-' + (2000 + i),
                    phone: '+1 (555) ' + (100 + i) + (1000 + i),
                    message: sampleMessages[Math.floor(Math.random() * sampleMessages.length)],
                    time: `${Math.floor(Math.random() * 12) + 1}:${Math.floor(Math.random() * 60).toString().padStart(2, '0')} ${Math.random() > 0.5 ? 'AM' : 'PM'}`,
                    status: Math.random() > 0.8 ? 'failed' : 'delivered',
                    lead: Math.random() > 0.5
                });
            }
            
            // Generate sample leads
            for (let i = 0; i < 10; i++) {
                AppState.leads.push({
                    id: 'lead-' + (3000 + i),
                    name: sampleParents[Math.floor(Math.random() * sampleParents.length)],
                    email: `parent${i}@example.com`,
                    program: ['robotics', 'coding', 'science', 'math'][Math.floor(Math.random() * 4)],
                    date: new Date(Date.now() - Math.random() * 30 * 24 * 60 * 60 * 1000).toLocaleDateString(),
                    status: ['new', 'contacted', 'enrolled', 'lost'][Math.floor(Math.random() * 4)]
                });
            }
        }
    </script>
</body>
</html>
